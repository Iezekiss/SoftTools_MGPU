
# üìò **–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4 ‚Äî –ê–Ω–∞–ª–∏–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ –∞–≤–∏–∞—Ä–µ–π—Å–æ–≤ (–í–∞—Ä–∏–∞–Ω—Ç 11)**

### *–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏—Ç—Ä–∏–Ω—ã, –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤*

---

## üîß **1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

–ü—Ä–æ–µ–∫—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–µ—Ä–µ—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∫–ª—é—á–∞–µ—Ç:

```
‚îú‚îÄ‚îÄ analysis.py                  # –§–∏–Ω–∞–ª—å–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑ Superset
‚îú‚îÄ‚îÄ avg_delay.png
‚îú‚îÄ‚îÄ combo.png
‚îú‚îÄ‚îÄ delay_airline.png
‚îú‚îÄ‚îÄ indicator.png
‚îú‚îÄ‚îÄ share_airline.png
‚îú‚îÄ‚îÄ flights.csv                  # –û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç
‚îÇ
‚îú‚îÄ‚îÄ dags/                        # DAG –¥–ª—è Airflow + —Ä–∞–±–æ—á–∏–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ dag_variant_11.py
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ airlines.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ airports.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flight_delays.csv
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ flights.csv
‚îÇ   ‚îî‚îÄ‚îÄ kaggle.json
‚îÇ
‚îú‚îÄ‚îÄ logs/                        # –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è DAG
‚îÇ
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îî‚îÄ‚îÄ datamart_variant_11.sql # SQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ç—Ä–∏–Ω—ã
‚îÇ
‚îú‚îÄ‚îÄ superset/
‚îÇ   ‚îî‚îÄ‚îÄ superset_config.py      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Superset (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Ä–∞–Ω–µ–µ)
‚îÇ
‚îú‚îÄ‚îÄ v3/                          # –§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è —Å dask/pandas
‚îÇ   ‚îú‚îÄ‚îÄ analysis.py
‚îÇ   ‚îú‚îÄ‚îÄ avg_delay.png
‚îÇ   ‚îú‚îÄ‚îÄ combo.png
‚îÇ   ‚îú‚îÄ‚îÄ delay_airline.png
‚îÇ   ‚îú‚îÄ‚îÄ indicator.png
‚îÇ   ‚îú‚îÄ‚îÄ share_airline.png
‚îÇ   ‚îî‚îÄ‚îÄ view.json
‚îÇ
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ –û–¢–ß–ï–¢ –õ–ë4.pdf
```

---

## üìë **2. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã**

1. –°–∫–∞—á–∞—Ç—å –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Kaggle.
2. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–∏—Ç—Ä–∏–Ω—É –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Ññ11:

   * month
   * airline
   * origin_airport
   * is_delayed (1/0)
   * arrival_delay_minutes
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ —Ä–µ–π—Å–æ–≤.
4. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–ª—Å—è –≤ Airflow + Postgres + Superset. –ò–∑-–∑–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã Superset –Ω–∞ macOS –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å pandas/matplotlib, –ø—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞.

---

## üì• **3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

–ò—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç: **flights.csv** (‚âà 5.8 –º–ª–Ω —Å—Ç—Ä–æ–∫).
–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–∞ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞ –≤–∏—Ç—Ä–∏–Ω–∞:

```
month
airline
origin_airport
is_delayed
arrival_delay_minutes
```

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏—Ç—Ä–∏–Ω—ã:

```python
df["is_delayed"] = (df["ARRIVAL_DELAY"] > 0).astype(int)

df_view = df[[
    "MONTH",
    "AIRLINE",
    "ORIGIN_AIRPORT",
    "ARRIVAL_DELAY",
    "is_delayed"
]].rename(columns={
    "MONTH": "month",
    "AIRLINE": "airline",
    "ORIGIN_AIRPORT": "origin_airport",
    "ARRIVAL_DELAY": "arrival_delay_minutes"
})
```

---

## üìä **4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏**

### **4.1 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–±—â–µ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∑–∞–¥–µ—Ä–∂–µ–∫**

‚Üí `indicator.png`

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–ª—é —Ä–µ–π—Å–æ–≤, –ø—Ä–∏—à–µ–¥—à–∏—Ö –ø–æ–∑–∂–µ –Ω—É–ª—è –º–∏–Ω—É—Ç.

### **4.2 –°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî % –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º**

‚Üí `delay_airline.png`

–ê–≤–∏–∞–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏ —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.

### **4.3 –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–π—Å–æ–≤ –ø–æ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º**

‚Üí `share_airline.png`

–ü–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –º–∞—Å—à—Ç–∞–± –∫–æ–º–ø–∞–Ω–∏–∏ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –∑–∞–¥–µ—Ä–∂–µ–∫.

### **4.4 –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–π—Å–æ–≤ –∏ % –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –º–µ—Å—è—Ü–∞–º**

‚Üí `combo.png`

–û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–¥–µ—Ä–∂–µ–∫.

### **4.5 –õ–∏–Ω–µ–π–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî —Å—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º**

‚Üí `avg_delay.png`

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –∑–∞–¥–µ—Ä–∂–∫–∏.

---

## üîç **5. –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–±–æ—Ä**

### **5.1 –û–±—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è**

* –î–æ–ª—è –∑–∞–¥–µ—Ä–∂–∞–Ω–Ω—ã—Ö —Ä–µ–π—Å–æ–≤ ‚Äî **–≤—ã—Å–æ–∫–∞—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è**, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã.
* –ó–∞–¥–µ—Ä–∂–∫–∏ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è –æ–¥–Ω–∏–º –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–º –∏–ª–∏ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–º.

### **5.2 –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å**

* –ü–∏–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–π—Å–æ–≤ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ **–ª–µ—Ç–Ω–∏–µ –º–µ—Å—è—Ü—ã (6‚Äì8)**.
* –í —ç—Ç–∏ –∂–µ –º–µ—Å—è—Ü—ã —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∏ –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ ‚Äî –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

### **5.3 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏–π**

* –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç –Ω–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–µ–∫.
* –£ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–≤ –∑–∞–º–µ—Ç–Ω—ã –≤—Å–ø–ª–µ—Å–∫–∏, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–±–æ–∏.

### **5.4 –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞**

* –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—Ç—ë—Ç –≤ –ø–µ—Ä–∏–æ–¥—ã –ø–∏–∫–æ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.
* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –≤ —è–Ω–≤–∞—Ä–µ‚Äì—Ñ–µ–≤—Ä–∞–ª–µ.

---

## üßæ **6. –ü—Ä–æ–±–ª–µ–º—ã, –≤–æ–∑–Ω–∏–∫—à–∏–µ –≤ —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã**

### **6.1 Airflow**

* DAG –∑–∞–ø—É—Å–∫–∞–ª—Å—è, –Ω–æ –±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ –ø—Ä–∏–≤–æ–¥–∏–ª –∫ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ–ø—ã—Ç–∫–∞–º.
* –õ–æ–≥–∏ (`logs/`) —Å–æ–¥–µ—Ä–∂–∞—Ç –∏—Å—Ç–æ—Ä–∏—é –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∏ —á–∞—Å—Ç–∏—á–Ω–æ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤.

### **6.2 Superset**

* –ù–∞ macOS –≤–æ–∑–Ω–∏–∫–∞–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

  * –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –≤–∏–¥–µ–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ hostname,
  * Superset –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–ª Postgres –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫,
  * –æ—à–∏–±–∫–∞ `Could not load database driver: PostgresEngineSpec`,
  * –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º `.venv`,
  * –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å `fab create-admin`.

–†–µ—à–µ–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–æ–º –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Python.

---

## üìò **7. –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥**

–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é: –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã, –≤–∏—Ç—Ä–∏–Ω–∞ —Å–æ–±—Ä–∞–Ω–∞, –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–µ–¥—ë–Ω, –≤—ã–≤–æ–¥—ã —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –∏ Superset, —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—é —Ç—Ä–µ–±—É–µ–º—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ –æ—Ñ–æ—Ä–º–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –≤–∏–¥–µ. –ù–∞ –±–æ–ª—å—à–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ —Ö–æ—Ä–æ—à–æ –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è–º–∏ –∏ –≤–ª–∏—è–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.
